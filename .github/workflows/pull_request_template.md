## Context
This PR contains Python code under active development.

## What to review (AI Reviewer)
Please provide feedback on:
1. Line-level issues and potential bugs
2. Edge cases and error handling
3. Function structure and readability
4. Suggested refactors (if any)
5. Missing docstrings, type hints, or comments
6. Performance or numerical issues (if applicable)

## Review style
- Prefer specific, actionable comments
- Reference exact lines or functions where possible
- Suggest concrete code improvements
